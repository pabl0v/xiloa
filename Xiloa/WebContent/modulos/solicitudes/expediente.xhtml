<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
       <link type="text/css" rel="stylesheet" href="../../resources/css/expediente.css"></link>
    </h:head>
    <h:body>
    <div id="contenedor">
        <div id="header">
            <ui:insert name="header" >
                <ui:include src="../../modulos/compartido/paginamaestra.xhtml" />
	    	</ui:insert>
	    	<script type="text/javascript" src="../../resources/scripts/expediente.js"></script>
		</div>
		<h:form id="formExpediente" enctype="multipart/form-data" >
    	<h2 style="display:inline-block;">Expediente Participante</h2>    		
    		
    		<p:commandButton id="enviarSolicitud" value="Enviar Solicitud" title="Solicitar Certificacion" 
    		                 icon="ui-icon-star" style="display:inline-block;"
    		                 actionListener="#{expedienteManagedBean.solicitarCertificacion}" 
    					     update=":formExpediente:msgExpediente"    					        					       
             				/>    		
    	<div>
    		<p:messages id="msgExpediente" showDetail="true" autoUpdate="true" closable="true" />
    	</div>
    	
    	<h3>Datos del solicitante/Candidato</h3>
    	<div id="seccion_datossolicitante" class="seccion_expediente" style="padding:10px;">   		 	  
    		<h:outputLabel styleClass="estilo_label" for="nombreCandidato" value="Nombre del candidato:" />
    		<h:outputText styleClass="estilo_span" id="nombreCandidato" value="#{expedienteManagedBean.solicitudExp.contacto.nombreCompleto}" />            
            <h:outputLabel styleClass="estilo_label" for="numeroIdentificacion" value="Numero de identificacion:" />
            <h:outputText styleClass="estilo_span" id="numeroIdentificacion" value="#{expedienteManagedBean.solicitudExp.contacto.numeroIdentificacion}" />            
            <h:outputLabel styleClass="estilo_label" for="certificacionNombre" value="Solicitud para evaluar:" />            
            <h:outputText styleClass="estilo_span" id="certificacionNombre" value="#{expedienteManagedBean.solicitudExp.certificacion.nombre}" />
            <h:outputLabel styleClass="estilo_label" for="genero" value="Genero:" />  
            <p:selectOneMenu id="genero" styleClass="selectores selector_genero" value="#{expedienteManagedBean.solicitudExp.contacto.sexo}" >                 
	       		 <f:selectItems value="#{expedienteManagedBean.listGenero}"/>  			                         
			</p:selectOneMenu>
            <!--  <p:inputText id="genero" value="#{expedienteManagedBean.solicitudExp.contacto.sexo}" /> -->            
            <h:outputLabel styleClass="estilo_label" for="telefono" value="Telefono:" />  
            <p:inputText id="telefono" value="#{expedienteManagedBean.solicitudExp.contacto.telefono1}" />
            <h:outputLabel styleClass="estilo_label" for="celular" value="Celular:" />  
            <p:inputText id="celular" value="#{expedienteManagedBean.solicitudExp.contacto.telefono2}" />
            <h:outputLabel styleClass="estilo_label" for="email1" value="Correo electronico:" />  
            <p:inputText id="email1" value="#{expedienteManagedBean.solicitudExp.contacto.correo1}" />
            <h:outputLabel styleClass="estilo_label" for="direccionActual" value="Direccion actual:" />  
            <p:inputText id="direccionActual" value="#{expedienteManagedBean.solicitudExp.contacto.direccionActual}" />
            <h:outputLabel styleClass="estilo_label" for="selector_departamento" value="Departamento:" />
            <p:selectOneMenu id="selector_departamento" styleClass="selector_status_estilo" 
                             value="#{expedienteManagedBean.solicitudExp.contacto.departamentoId}"                                                        
                             style="position: relative;top: 7px;margin-right: 5px;" >
				  <p:ajax listener="#{expedienteManagedBean.handleMunicipios}"
				          update=":formExpediente:selector_municipio" />
	       	<f:selectItems value="#{expedienteManagedBean.listDeptos}"/>	       		   	       		  		  	       		  			                         
			</p:selectOneMenu>			    
            <h:outputLabel styleClass="estilo_label" for="selector_municipio" value="Municipio:" />          	     
          	<p:selectOneMenu id="selector_municipio" styleClass="selector_status_estilo"
            				 value="#{expedienteManagedBean.solicitudExp.contacto.municipioId}"                              
                             style="position: relative;top: 7px;margin-right: 5px;">
	       		  <f:selectItems value="#{expedienteManagedBean.listMunicipioByDptos}"/>	       		   	       		  		  	       		  			                         
			</p:selectOneMenu>     	
            <p:commandButton id="btnActualizaContacto" disabled="#{expedienteManagedBean.disabledBtnActualizaContacto}"
                             style="display:block;" value="Aplicar Cambios" 
                             update=":formExpediente:msgExpediente" 
                             action="#{expedienteManagedBean.actualizarContacto}" />          
    	</div>    	
    	<div class="barra_azul">  
    		<p style="padding: 7px;font-weight:bold;">Trayectoria profesional y academica:</p>    		
           	<div>
           		<p:commandButton id="btnAgregaLaborales" disabled="#{expedienteManagedBean.disabledBtnAgregaLaborales}"
           		                 action="#{expedienteManagedBean.nuevoLaboral}" value="Agregar"
           		                 oncomplete="PF('dlg1').show();"  process="@form" update=":formExpediente:modalLaborales" />
           	</div>              
    	</div>	
    	<div id="contenedor_datos_lab" class="seccion_expediente">	    					
    		<p:tabView id="tabView_datosLaborales">    			   
            	<p:tab id="tab1" title="Experiencia">                    	  
                	<p:dataTable emptyMessage="No hay datos para mostrar" var="datosLaborales" 
                				 value="#{expedienteManagedBean.listDatosLaborales}" selection="#{expedienteManagedBean.selectedLaboral}" 
                				 rowKey="#{datosLaborales}" selectionMode="single" paginator="true" rows="4" >      
                    	<p:column headerText="Empresa"><h:outputText value="#{datosLaborales.institucion}" /></p:column>  
                         <p:column headerText="Cargo"><h:outputText value="#{datosLaborales.cargo}" /></p:column>  
                         <p:column headerText="Desde"><h:outputText value="#{datosLaborales.fechaInicia}" pattern="dd/mm/yyyy" /></p:column>  
                         <p:column headerText="Hasta"><h:outputText value="#{datosLaborales.fechaFinaliza}" pattern="dd/mm/yyyy" /></p:column>  
                         <p:column headerText="Direccion"><h:outputText value="#{datosLaborales.institucionDireccion}" /></p:column>                         
                         <p:column headerText="Editar Registro" >                         	    
    						<p:splitButton action="#{expedienteManagedBean.editarLaboral}" 
    						               update=":formExpediente:modalLaborales" oncomplete="PF('dlg1').show();" 
    						               icon="ui-icon-pencil" >
    						     <f:setPropertyActionListener value="#{datosLaborales}" target="#{expedienteManagedBean.selectedLaboral}" />           	        	         
        						<p:menuitem value="Subir Archivo" action="#{expedienteManagedBean.nuevoPortafolio}"
        									oncomplete="PF('dlgPortafolio').show()"
        									update=":formExpediente:modalPortafolio" 
        						            icon="ui-icon-arrowrefresh-1-w" >
        						      <f:setPropertyActionListener value="#{datosLaborales}" target="#{expedienteManagedBean.selectedLaboral}" />
        						</p:menuitem>
    						</p:splitButton>                          	
                         </p:column>                                         
                    </p:dataTable>    
               </p:tab>  

               <p:tab id="tab2" title="Estudios">                    	  
                   <p:dataTable emptyMessage="No hay datos para mostrar"  var="datosEstudios" 
                                value="#{expedienteManagedBean.listDatosEstudios}" selection="#{expedienteManagedBean.selectedLaboral}" 
                				 rowKey="#{datosEstudios}" selectionMode="single" paginator="true" rows="4" >  
                        <p:column headerText="Empresa"><h:outputText value="#{datosEstudios.institucion}" /></p:column>  
                        <p:column headerText="Cargo"><h:outputText value="#{datosEstudios.cargo}" /></p:column>  
                        <p:column headerText="Desde"><h:outputText value="#{datosEstudios.fechaInicia}" /></p:column>  
                        <p:column headerText="Hasta"><h:outputText value="#{datosEstudios.fechaFinaliza}" /></p:column>  
                        <p:column headerText="Direccion"><h:outputText value="#{datosEstudios.institucionDireccion}" /></p:column>  
                        <p:column headerText="Editar Registro">
	                        <p:splitButton action="#{expedienteManagedBean.editarLaboral}" 
	    						           update=":formExpediente:modalLaborales" oncomplete="PF('dlg1').show();" 
	    						           icon="ui-icon-pencil" title="Editar" >
	    						<f:setPropertyActionListener value="#{datosEstudios}" target="#{expedienteManagedBean.selectedLaboral}" />           	        	         
	        					<p:menuitem value="Subir Archivo" action="#{expedienteManagedBean.nuevoPortafolio}"
	        					      		oncomplete="PF('dlgPortafolio').show()"
	        								update=":formExpediente:modalPortafolio" 
	        						        icon="ui-icon-arrowrefresh-1-w" >
	        				        <f:setPropertyActionListener value="#{datosEstudios}" target="#{expedienteManagedBean.selectedLaboral}" />
	        					</p:menuitem>
	    					</p:splitButton>
                        </p:column>  
                   </p:dataTable>       
               </p:tab>  

               <p:tab id="tab3" title="Calificaciones">                    	  
                   <p:dataTable emptyMessage="No hay datos para mostrar"  var="datosCalificacion" 
                                value="#{expedienteManagedBean.listDatosCalificacion}" selection="#{expedienteManagedBean.selectedLaboral}" 
                				 rowKey="#{datosCalificacion}" selectionMode="single" paginator="true" rows="4" >  
                        <p:column headerText="Empresa"><h:outputText value="#{datosCalificacion.institucion}" /></p:column>  
                        <p:column headerText="Cargo"><h:outputText value="#{datosCalificacion.cargo}" /></p:column>  
                        <p:column headerText="Desde"><h:outputText value="#{datosCalificacion.fechaInicia}" /></p:column>  
                        <p:column headerText="Hasta"><h:outputText value="#{datosCalificacion.fechaFinaliza}" /></p:column>  
                        <p:column headerText="Direccion"><h:outputText value="#{datosCalificacion.institucionDireccion}" /></p:column>  
                        <p:column headerText="Editar Registro">
                            <p:splitButton action="#{expedienteManagedBean.editarLaboral}" 
	    						           update=":formExpediente:modalLaborales" oncomplete="PF('dlg1').show();" 
	    						           icon="ui-icon-pencil" title="Editar" >
	    						<f:setPropertyActionListener value="#{datosCalificacion}" target="#{expedienteManagedBean.selectedLaboral}" />           	        	         
	        					<p:menuitem value="Subir Archivo" action="#{expedienteManagedBean.nuevoPortafolio}"
	        					      		oncomplete="PF('dlgPortafolio').show()"
	        								update=":formExpediente:modalPortafolio" 
	        						        icon="ui-icon-arrowrefresh-1-w" >
	        				        <f:setPropertyActionListener value="#{datosCalificacion}" target="#{expedienteManagedBean.selectedLaboral}" />
	        					</p:menuitem>
	    					</p:splitButton>                        	
						</p:column>  
                   </p:dataTable>    
               </p:tab>  
                    
               <p:tab id="tab4" title="Certificaciones">                    	  
                   <p:dataTable emptyMessage="No hay datos para mostrar"  var="datosCertificacion" value="#{expedienteManagedBean.listDatosCertificaciones}" 
                                selection="#{expedienteManagedBean.selectedLaboral}" rowKey="#{datosCertificacion}" 
                                selectionMode="single" paginator="true" rows="4" >  
                        <p:column headerText="Empresa"><h:outputText value="#{datosCertificacion.institucion}" /></p:column>  
                        <p:column headerText="Cargo"><h:outputText value="#{datosCertificacion.cargo}" /></p:column>  
                        <p:column headerText="Desde"><h:outputText value="#{datosCertificacion.fechaInicia}" /></p:column>  
                        <p:column headerText="Hasta"><h:outputText value="#{datosCertificacion.fechaFinaliza}" /></p:column>  
                        <p:column headerText="Direccion"><h:outputText value="#{datosCertificacion.institucionDireccion}" /></p:column>  
                        <p:column headerText="Editar Registro">
                        	<p:splitButton action="#{expedienteManagedBean.editarLaboral}" 
	    						           update=":formExpediente:modalLaborales" oncomplete="PF('dlg1').show();" 
	    						           icon="ui-icon-pencil" title="Editar" >
	    						<f:setPropertyActionListener value="#{datosCertificacion}" target="#{expedienteManagedBean.selectedLaboral}" />           	        	         
	        					<p:menuitem value="Subir Archivo" action="#{expedienteManagedBean.nuevoPortafolio}"
	        					      		oncomplete="PF('dlgPortafolio').show()"
	        								update=":formExpediente:modalPortafolio" 
	        						        icon="ui-icon-arrowrefresh-1-w" >
	        				        <f:setPropertyActionListener value="#{datosCertificacion}" target="#{expedienteManagedBean.selectedLaboral}" />
	        					</p:menuitem>
	    					</p:splitButton>							                        
						</p:column>  
                   </p:dataTable>    
               </p:tab>  
           </p:tabView>  		
    	</div>
   	    <div id="contenedor_tab_planes" class="seccion_expediente" style="width:98%">
	   	    <p:dataTable emptyMessage="No hay datos"  var="dtEvaluaciones" value="#{expedienteManagedBean.listBeanEvalFormacion}"
                         selection="#{expedienteManagedBean.selectedBeanEvaluacion}" rowKey="#{dtEvaluaciones}" 
             			 selectionMode="single" paginator="true" rows="4" >   
             	 <f:facet name="header">Detalle de Evaluaciones</f:facet>                        	 
                 <p:column headerText="Elemento de Competencia o Realizacion Profesional"><h:outputText value="#{dtEvaluaciones.unidadCompetenciaDescripcion}" /></p:column>  
                 <p:column headerText="Tecnica o instrumento de evaluacion"><h:outputText value="#{dtEvaluaciones.instrumento.nombre} [ #{dtEvaluaciones.instrumento.tipo.valor} ]" /></p:column>                               
                 <p:column headerText="Observaciones"><h:outputText value="#{dtEvaluaciones.evaluacion.observaciones}" /></p:column>                                  
                 <p:column headerText="Fecha"><h:outputText value="#{dtEvaluaciones.evaluacion.fechaEvaluacion}" /></p:column>
                 <p:column headerText="Aprobado"><p:selectBooleanCheckbox value="#{dtEvaluaciones.evaluacion.aprobado}" /></p:column>    
                 <p:column headerText="Estado"><h:outputText value="#{dtEvaluaciones.estadoEvaluacion.valor}" /></p:column>
	         </p:dataTable>
   	    </div>    	
    	<!-- Cuadro de dialogo emergente que registra datos laborales y académicos -->    	    	
    	<p:dialog id="modalLaborales" styleClass="estilo_dialogoLaborales" header="Agregar Datos Laborales y Academicos:" widgetVar="dlg1" 
    	          modal="true" resizable="false" width="720" height="540" showEffect="clip" hideEffect="clip" >
    	   <div id="modal_laborales">					
				<h3 style="margin-left: -11px;">Registro de Datos Laborales y Academicos</h3>					
				<p style="margin-left: 4px;">Tipo dato laboral:</p>			
				<p:selectOneMenu styleClass="selectores bloque" id="selector_tipoDatoLaboral" value="#{expedienteManagedBean.tipoLaboral}" >				
					<f:selectItems value="#{expedienteManagedBean.listTipoDatosLaborales}" />			        
			    </p:selectOneMenu>					
			    <div class="dialogoLaborales_secciones" >					
					<p>Nombre de la institucion:</p>  
	            	<p:inputText id="nombreInstitucion" value="#{expedienteManagedBean.nombreInstitucion}" />	            	
	            	<p>Telefono contacto:</p>	                  
	            	<p:inputText id="telefonoInstitucion" value="#{expedienteManagedBean.telefonoInstitucion}" />										
					<p>Pais:</p>    	
	            	<p:selectOneMenu id="selector_paisLaboral" styleClass="selectores bloque"  
	            	                 value="#{expedienteManagedBean.paisIdLaboral}" >				
						<f:selectItems value="#{expedienteManagedBean.listPaises}" />			        
			    	</p:selectOneMenu>	            	
					<p>Direccion de la institucion:</p>					  
            		<p:inputText id="institucionDireccion" value="#{expedienteManagedBean.institucionDireccion}" />
				</div>				
				<div class="dialogoLaborales_secciones" >
					<p>Cargo:</p>	                  
	            	<p:inputText id="nombreCargo" value="#{expedienteManagedBean.nombreCargo}" />
	            	<p>Descripcion Cargo:</p>	                  
	            	<p:inputText id="descripcionCargo" value="#{expedienteManagedBean.descripcionCargo}" />
	            	<p:growl id="growlFechaDesde" showDetail="true"/>
	            	<p>Fecha Desde:</p>					
					<p:calendar value="#{expedienteManagedBean.fechaDesde}" pattern="dd/mm/yyyy" id="popupButtonCal1" showOn="button">
						<p:ajax event="dateSelect" update="growlFechaDesde" />
					</p:calendar>				
					<p:growl id="growlFechaHasta" showDetail="true"/>
					<p>Fecha Hasta:</p>					
					<p:calendar value="#{expedienteManagedBean.fechaHasta}" pattern="dd/mm/yyyy" id="popupButtonCal2" showOn="button">
						<p:ajax event="dateSelect" update="growlFechaHasta" />
					</p:calendar>
				</div>				    	    							
				<div style="float:right;">
					<p:commandButton value="Cancelar" action="#{expedienteManagedBean.limpiarCampos}" oncomplete="PF('dlg1').hide();" />
					<p:commandButton value="Aceptar" action="#{expedienteManagedBean.guardarDatosLaborales}" oncomplete="PF('dlg1').hide();"
									 update=":formExpediente:tabView_datosLaborales, :formExpediente:msgExpediente"	/>
				</div>
				    
				<p:dataTable id="dtPortafolioLaboral" emptyMessage="No hay datos"  var="varPortafolioLaboral" 
				             value="#{expedienteManagedBean.listPortafolioLaboral}"				             
						     selection="#{expedienteManagedBean.selectedArchivoId}"
							 selectionMode="single" rowKey="#{varPortafolioLaboral}" 
                 			  paginator="true" rows="3" style="margin-top:8px;" >  
                             <f:facet name="header">  
					            Portafolio de Evidencias  
					         </f:facet> 
                             <p:column headerText="Documento de soporte o evidencia"><h:outputText value="#{varPortafolioLaboral.nombre}" /></p:column>  
                             <p:column headerText="Descripcion"><h:outputText value="#{varPortafolioLaboral.descripcion}" /></p:column>  
                             <p:column headerText="Respaldo de"><h:outputText value="#{varPortafolioLaboral.laboral.nombre}" /></p:column>  
                             <p:column headerText="Estado"><h:outputText value="#{varPortafolioLaboral.estado.valor}" /></p:column>                                   
               </p:dataTable>
		    </div>					
		</p:dialog>    	
    	<!--  Fin Cuadro de dialogo emergente que registra datos laborales y académicos -->
    	
    	<!-- ******************************************************************************************** -->    	
    	
    	<!-- Cuadro de dialogo emergente que registra datos laborales y académicos -->    	    	
    	<p:dialog id="modalPortafolio" styleClass="estilo_modalPortafolio" header="Registro de Archivos al portafolio de evidencias" 
    	          widgetVar="dlgPortafolio" 
    	          modal="true" resizable="false" width="540" height="450" showEffect="clip" hideEffect="explode" >
    	   <div id="modal_Portafolio">									
				<p style="margin-left: 4px;">Datos Laborales / Academicos:</p>			
			    <p style="margin-left: 4px;font-weight:bold;">#{expedienteManagedBean.selectedLaboral.nombre} </p>	    
			    <div class="dialogoPortafolio_secciones" >
			    	<p>Nombre del Archivo:</p>  
	            	<p:inputText id="nombreArchivo" value="#{expedienteManagedBean.nombreArchivoExp}" />
	            	<p>Tipo Archivo:</p>
	                <p:selectOneMenu id="tipoArchivo" value="#{expedienteManagedBean.tipoArchivoExp}">  
                		<f:selectItem itemLabel="Formato PDF" itemValue="PDF" />
                		<f:selectItem itemLabel="Imagen jpeg" itemValue="JPEG" />
            		</p:selectOneMenu>             
					<p>Version:</p>	                  
	            	<p:inputText id="versionArchivo" value="#{expedienteManagedBean.versionArchivoExp}" />	            	           	 
					<p>Descripcion:</p>	                  
	            	<p:inputText id="descripcionArchivo" value="#{expedienteManagedBean.descripcionArchivoExp}" />
	            	<p:fileUpload id="fileEvidencia" fileUploadListener="#{expedienteManagedBean.uploadFile}" 
	            	 			  mode="advanced" dragDropSupport="false"  auto="true" sizeLimit="2097152"  
	            	              allowTypes="/(\.|\/)(gif|jpe?g|png|pdf|PDF)$/" fileLimit="1"	            	              
	            	              update=":formExpediente:messages, :formExpediente:nombreRealArchivo, :formExpediente:sizeArchivo" />
					<p:growl id="messages" showDetail="true"/>	            	
					<p>Archivo (Nombre Real):</p>  
					<h:outputText styleClass="estilo_span" id="nombreRealArchivo" value="#{expedienteManagedBean.nombreRealArchivoExp}" />
					<p>Tamaño del Archivo:</p>  
					<h:outputText styleClass="estilo_span" id="sizeArchivo" value="#{expedienteManagedBean.sizeArchivoExp}" />
				</div>				
				<p:commandButton value="Cancelar" action="#{expedienteManagedBean.cancelaPortafolio}" onclick="PF('dlgPortafolio').hide();"/>
				<p:commandButton value="Guardar" action="#{expedienteManagedBean.guardarArchivo}" oncomplete="PF('dlgPortafolio').hide();" />												
		    </div>					
		</p:dialog>
		
    	</h:form>
    </div> 
</h:body>
</html>
