<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
	<link type="text/css" rel="stylesheet" href="../../resources/css/solicitudes.css"></link>
    </h:head>
    <h:body>
 
    <div id="contenedor">
    	<div id="header">
            <ui:insert name="header" >
                <ui:include src="../../modulos/compartido/paginamaestra.xhtml" />
	    	</ui:insert>
	    	 <script type="text/javascript" src="../../resources/scripts/solicitudes.js"></script>
		</div>		
        
        <div id="cabezera">
            <h2>Solicitudes Activas</h2>                  
            <div id="botones_filtro_contenedor">                 
                <div class="botones_filtro" onclick="window.location='/Xiloa/modulos/solicitudes/registro_solicitud.xhtml'" >
                	<p class="icono_nuevo">Nueva solicitud</p>
                </div>  
                <div class="botones_filtro" onclick="window.location='/Xiloa/modulos/solicitudes/convocatoria.xhtml'">
                	<p class="icono_folder">Convocatoria</p>
                </div>            
            </div>
       </div>
        <h:form>
        <div id="contenedor_filtro">            
	            <p>Buscar:</p>
	            <p:selectOneMenu styleClass="selectores" id="selector_buscarByAll" value="#{dashBoardSolicitudesManagedBean.selectedBuscarByAll}">
	            	<f:selectItems value="#{dashBoardSolicitudesManagedBean.listBuscarByAll}"/>	            			        
			    </p:selectOneMenu>
		        <p:inputText style="margin-right:10px;" id="filtro_buscarByAll" value="#{dashBoardSolicitudesManagedBean.buscarByAllValue}">
		        	<p:ajax event="keyup" update="dtSolicitud" listener="#{dashBoardSolicitudesManagedBean.handleBuscar}" process="@form" />
		        </p:inputText>
	            <p>Centro evaluador:</p>
	            <p:selectOneMenu styleClass="selectores" id="selector_centrosBySolicitud" value="#{dashBoardSolicitudesManagedBean.selectedIdIfpSolicitud}" >			        
			        <f:selectItems value="#{dashBoardSolicitudesManagedBean.listCentrosBySolicitud}"/>
			        <p:ajax update="selector_certificacionByCentro, dtSolicitud"  listener="#{dashBoardSolicitudesManagedBean.handleCertByCentro}" />
			    </p:selectOneMenu>
			    <p>Certificaciones:</p>
	            <p:selectOneMenu styleClass="selectores" id="selector_certificacionByCentro" value="#{dashBoardSolicitudesManagedBean.selectedIdCertByCentro}" >			        
			        <f:selectItems value="#{dashBoardSolicitudesManagedBean.listCertByCentro}" />
			        <p:ajax update="dtSolicitud" listener="#{dashBoardSolicitudesManagedBean.handleBuscar}" />  
			    </p:selectOneMenu>			  
        </div>              
        <div id="contenedor_tabla_solicitudes">           
        	<p:dataTable id="dtSolicitud" widgetVar="dtSolicitudes" emptyMessage="No existen solicitudes activas" 
        	             var="varSolicitudI" value="#{dashBoardSolicitudesManagedBean.listaSolicitudes}" 
        	             selectionMode="single" filteredValue="#{dashBoardSolicitudesManagedBean.filterSolicitudes}"
        	             selection="#{dashBoardSolicitudesManagedBean.selectedSolicitud}"         	              
        	             paginator="true" rows="12" rowKey="#{varSolicitudI}" >        	      
        		
        		<f:facet name="header">  
            		<p:outputPanel>  
                		<h:outputText value="Buscar por todas las columnas:" />  
                		<p:inputText id="globalFilter" onkeyup="dtSolicitudes.filter()" style="width:200px" />  
            		</p:outputPanel>  
        		</f:facet>
        		                               
	            <!--Las columnas de la tabla-->
                <p:column id="centroColumn" headerText="Centro evaluador"><h:outputText value="#{varSolicitudI.certificacion.ifpNombre}" /></p:column>                      
                <p:column id="candidatoColumn" headerText="Nombre del candidato"><h:outputText value="#{varSolicitudI.contacto.nombreCompleto}" /></p:column>  
                <p:column id="certificacionColumn" headerText="Certificacion a evaluar"><h:outputText value="#{varSolicitudI.certificacion.nombre}"/></p:column>  
                <p:column id="fechaColumn" headerText="Fecha solicitud"><h:outputText value="#{varSolicitudI.fechaRegistro}" /></p:column>               
                <p:column id="evaluadorColumn" headerText="Evaluador"><h:outputText value="#{varSolicitudI.contacto.correo1}" /></p:column>                
                <p:column id="estadoColumn" headerText="Estado"><h:outputText value="#{varSolicitudI.estatus.valor}" /></p:column>                
                <p:column style="width:4%">  
	            	<p:commandButton id="selectButton" action="#{dashBoardSolicitudesManagedBean.editaSolicitud}"	            				     
	            	                 icon="ui-icon-pencil" title="Editar">  
        				<f:setPropertyActionListener value="#{varSolicitudI}" target="#{expedienteManagedBean.solicitudExp}" />        				        				        				  
        			</p:commandButton>  
    			</p:column>
    			  
            </p:dataTable>            
        </div>
        <div id="contenedor_exportar">
    		<p>Con seleccionado:</p>
	    	<p:selectOneMenu styleClass="selectores" id="selector_accionConvocatoria" value="#{dashBoardSolicitudesManagedBean.selectedAccionConvo}">
    			<f:selectItem itemLabel="Autorizar" itemValue="1" />  
    			<f:selectItem itemLabel="Exportar a Excel" itemValue="2" />  
    			<f:selectItem itemLabel="Exportar a PDF" itemValue="3" />	    		            			        
	    	</p:selectOneMenu>    	
    	</div>
     </h:form>
    </div>        
    
</h:body>
</html>