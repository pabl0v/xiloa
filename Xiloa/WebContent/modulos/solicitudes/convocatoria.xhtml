<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
	<link type="text/css" rel="stylesheet" href="../../resources/css/solicitudes.css"></link>
    </h:head>
    <h:body>
 
    <div id="contenedor">
    	<div id="header">
            <ui:insert name="header" >
                <ui:include src="../../modulos/compartido/paginamaestra.xhtml" />
	    	</ui:insert>
	    	 <script type="text/javascript" src="../../resources/scripts/solicitudes.js"></script>
		</div>
		
        <h:form id="formConvocatoria">
        <div id="cabezera">
            <h2>Solicitudes Activas</h2>
       </div>
        
        <div id="contenedor_filtro">            
	            <p style="margin-left:5px;margin-bottom: 12px;">Buscar:</p>
	            <p:selectOneMenu styleClass="selectores" id="selector_buscarByAll" value="#{convocatoriaManagedBean.selectedBuscarByAll}">
	            	<f:selectItems value="#{convocatoriaManagedBean.listBuscarByAll}"/>	            			        
			    </p:selectOneMenu>
		        <p:inputText style="margin-right:10px;" id="filtro_buscarByAll" value="#{convocatoriaManagedBean.buscarByAllValue}">
		        	<p:ajax event="keyup" update="dtSolicitud" listener="#{convocatoriaManagedBean.handleBuscar}" process="@form" />
		        </p:inputText>
		        <span style="display:inline-block; margin-left:5px">
		            <p>Centro evaluador:</p>
		            <p:selectOneMenu styleClass="selectores selector_centrosBySolicitudEstilo" id="selector_centrosBySolicitud" value="#{convocatoriaManagedBean.selectedIdIfpSolicitud}" >			        
				        <f:selectItems value="#{convocatoriaManagedBean.listCentrosBySolicitud}"/>
				        <p:ajax update="selector_certificacionByCentro, dtSolicitud"  listener="#{convocatoriaManagedBean.handleCertByCentro}" />
				    </p:selectOneMenu>
			    </span>
			    <span style="display:inline-block; margin-left:5px">
				    <p>Certificaciones:</p>
		            <p:selectOneMenu styleClass="selectores selector_certificacionByCentroEstilo" id="selector_certificacionByCentro" value="#{convocatoriaManagedBean.selectedIdCertByCentro}" >			        
				        <f:selectItems value="#{convocatoriaManagedBean.listCertByCentro}" />
				        <p:ajax update="dtSolicitud" listener="#{convocatoriaManagedBean.handleBuscar}" />  
				    </p:selectOneMenu>	
			    </span>	

			    <p:commandButton id="aplicarSeguimiento" value="Aplicar Seguimiento"
			                     action="#{convocatoriaManagedBean.handleConvocatoria}" 	            	                             				     
	           	                 icon="ui-icon-disk" title="Aplicar Seguimiento"
	           	                 update=":formConvocatoria:dtSolicitud, :formConvocatoria:msgConvocatoria"  />   	           		 
			    	  
        </div>              
        <div id="contenedor_tabla_solicitudes">           
        	<p:messages id="msgConvocatoria" showDetail="true" autoUpdate="true" closable="true" />
        	<p:dataTable id="dtSolicitud" widgetVar="dtSolicitudes" emptyMessage="No existen solicitudes activas" var="varSolicitudI" 
        	             value="#{convocatoriaManagedBean.listaSolicitudes}" 
        	             selection="#{convocatoriaManagedBean.selectedListSolicitud}"
        	             paginator="true" rows="12" rowKey="#{varSolicitudI.id}" >        	                                        	             
	            <!--Las columnas de la tabla-->	                
                <p:column id="centroColumn" headerText="Centro evaluador" exportable="true"><h:outputText value="#{varSolicitudI.certificacion.ifpNombre}" /></p:column>                      
                <p:column id="candidatoColumn" headerText="Nombre del candidato" exportable="true"><h:outputText value="#{varSolicitudI.contacto.nombreCompleto}" /></p:column>  
                <p:column id="certificacionColumn" headerText="Certificacion a evaluar" exportable="true"><h:outputText value="#{varSolicitudI.certificacion.nombre}"/></p:column>  
                <p:column id="fechaColumn" headerText="Fecha solicitud" exportable="true"><h:outputText value="#{varSolicitudI.fechaRegistro}" /></p:column>               
                <p:column id="evaluadorColumn" headerText="Evaluador" exportable="true"><h:outputText value="#{varSolicitudI.contacto.correo1}" /></p:column>                
                <p:column id="estadoColumn" headerText="Estado" exportable="true"><h:outputText value="#{varSolicitudI.estatus.valor}" /></p:column>
                <p:column id="selectConvo" selectionMode="multiple" style="width:2%" exportable="false" />                
            </p:dataTable>            
        </div>        
     </h:form>
    </div>    
</h:body>
</html>