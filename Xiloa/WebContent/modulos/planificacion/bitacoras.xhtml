<?xml version='1.0' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
	  xmlns:sec="http://www.springframework.org/security/tags">
    <h:head>
    	<link type="text/css" rel="stylesheet" href="../../resources/css/bitacoras.css"></link>
    </h:head>
    <h:body>
     <div id="contenedor">
    	<div id="header">
            <ui:insert name="header" >
                <ui:include src="../../modulos/compartido/paginamaestra.xhtml" />
	    	</ui:insert>
	        <script type="text/javascript" src="../../resources/scripts/bitacoras.js"></script>
		</div>
        <div id="cabezera" style="margin-left: 25px;">
            <h2>Ejecuci칩n de actividades</h2>            
            <div>
            	<br/>
            	<b>Certificaci칩n: </b> <i><h:outputText value="#{actividadManagedBean.actividad.certificacion.nombre}"/></i>
            	<br/> 
            	<b> Centro: </b> <i><h:outputText value="#{actividadManagedBean.actividad.certificacion.ifpNombre}"/></i>
            	<br/> 
            	<b>Actividad: </b> <i><h:outputText value="#{actividadManagedBean.actividad.nombre}"/> / <h:outputText value="#{actividadManagedBean.actividad.tipo.valor}"/></i>
            	<br/> 
            	<b>Fecha prevista: </b> <i><h:outputText value="#{actividadManagedBean.actividad.fechaInicial}"><f:convertDateTime type="date" pattern="dd/MM/yyyy"/></h:outputText></i>
            	<br/>
            	<b>Estado: </b> <i><h:outputText value="#{actividadManagedBean.actividad.estado.valor}"/></i>
            	<br/>
        	</div>
        </div>
		<div id="contenedor_secciones">
	        <div class="seccion_edicion" style="width: 93%;margin-top:15px;margin-left: 35px;">
	             <h:form id="form_bitacoras">
					<p:commandButton value="Agregar" style="margin-bottom: 5px" action="#{actividadManagedBean.agregarBitacora}" update=":form_bitacora" onclick="PF('dlg2').show();" >
					</p:commandButton>
	                <p:dataTable id="bitacorasDataTable" var="bitacora" value="#{actividadManagedBean.bitacoras}">
	                     <p:column headerText="Fecha Evento"><h:outputText value="#{bitacora.fechaEvento}" ><f:convertDateTime type="date" pattern="dd/MM/yyyy"/></h:outputText></p:column>  
	                     <p:column headerText="Observaciones"><h:outputText value="#{bitacora.observaciones}"/></p:column>
						 <p:column headerText="Fecha Registro"><h:outputText value="#{bitacora.fechaRegistro}" ><f:convertDateTime type="date" pattern="dd/MM/yyyy"/></h:outputText></p:column>
	                     <p:column headerText="Usuario"><h:outputText value="#{bitacora.usuario.nombreCompleto}" /></p:column>
	                </p:dataTable> 
	                <h:commandButton class="botones" style="float:right;" value="Cerrar" action="#{actividadManagedBean.cerrar}"/> 	
	            </h:form>    
			</div>
			
		</div>

    </div>

       <p:dialog id="modalBitacora" styleClass="modal_agregar_bitacora" header="Agregar bitacora" widgetVar="dlg2" modal="true" width="450" height="400" resizable="false">  
         <h:form id="form_bitacora" class="form_bitacora_estilo" >
             <h3>Bit치cora</h3>  
			 <p>Fecha del Evento:</p> 
			 <p:calendar id="fecha_evento" required="true" requiredMessage="La fecha es requerida" value="#{actividadManagedBean.bitacora.fechaEvento}" showOn="button" pattern="dd/MM/yyyy"/>
			 <p:message for="fecha_evento" display="text"  />
             <h3>Descripci칩n del evento</h3>
             <p:inputTextarea id="descripcion" required="true" requiredMessage="La descripcion es requerida" rows="12" cols="65" value="#{actividadManagedBean.bitacora.observaciones}" queryDelay="750" minQueryLength="4" />
             <p:message for="descripcion" display="text"  />
             <p:commandButton styleClass="botones" value="Cancelar" onclick="PF('dlg2').hide();" immediate="true" />
			 <p:commandButton styleClass="botones" value="Aceptar" oncomplete="if(!args.validationFailed) {dlg2.hide()} else {dlg2.show()}" action="#{actividadManagedBean.guardarBitacora(actividadManagedBean.bitacora)}" update=":form_bitacoras:bitacorasDataTable, :form_bitacora" ajax="true" />
         </h:form>
    </p:dialog>
</h:body>
</html>