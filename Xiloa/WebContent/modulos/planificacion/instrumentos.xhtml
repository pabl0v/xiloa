<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">  
    <h:head>
        <link type="text/css" rel="stylesheet" href="../../resources/css/instrumentos.css"></link>
    </h:head>
    <h:body>
    <div id="contenedor">      
      	<div id="header">
            <ui:insert name="header" >
	             <ui:include src="../../modulos/compartido/paginamaestra.xhtml" />
		    </ui:insert>
		    <script type="text/javascript" src="../../resources/scripts/instrumentos.js"></script>
		</div>
        <h2>Configuracion de Instrumentos - <h:outputText value="#{instrumentoManagedBean.nombreCertificacion}" /> </h2>
        <div id="contenedor_secciones">
		            <div class="seccion_edicion">
		                <h:form styleClass="formulario_inline">
		                    <p:commandButton value="Agregar guia" update=":guiaDialogo" action="#{instrumentoManagedBean.nuevaGuia}" onclick="PF('dlg1').show();"/> 
		                </h:form>
						<div class="seccion_interna">
						<h:form id="guias">
		                   <p:dataTable id="display" emptyMessage="No hay datos para mostrar"  var="guia" value="#{instrumentoManagedBean.selectedInstrumento.guias}" selection="#{instrumentoManagedBean.selectedGuia}" paginator="true" rows="10" rowKey="#{guia.id}" selectionMode="single">  
		                        <p:column headerText="Pregunta"><h:outputText value="#{guia.pregunta}" /></p:column>  
		                        <p:column headerText="Respuesta"><h:outputText value="#{guia.respuesta}" /></p:column>  
		                        <p:column headerText="Puntaje"><h:outputText value="#{guia.puntaje}" /></p:column>  
		                        <p:column headerText="Estado"><h:outputText value="#{guia.estatusLabel}" /></p:column>
								<p:column headerText="Editar" style="width:4%">
									<p:commandButton id="selectButton" action="#{instrumentoManagedBean.editarGuia(instrumentoManagedBean.selectedGuia)}" update=":guiaDialogo" icon="ui-icon-pencil" title="Editar" onclick="PF('dlg1').show();"/>  
								</p:column>		                        
		                    </p:dataTable>
		                </h:form>
		                </div>		                
		          </div>
		          
		         <div class="seccion_edicion">
		         	<h:form>
		          	<div class="contenedor_botones">
						<h:commandButton value="Aceptar" action="#{instrumentoManagedBean.aceptar}"/> 
					</div>
					</h:form>
				</div>
		          		          
		          <div class="seccion_edicion" style="width: 93%;margin-top: 124px;">
		          		<h:form id="instrumentos">
		          		<p:commandButton value="Agregar Instrumento" style="margin-bottom: 5px" update=":instrumentoDialogo" action="#{instrumentoManagedBean.nuevoInstrumento}" onclick="PF('dlg2').show();"/>
						<p:dataTable id="instrumentosDataTable" emptyMessage="No hay datos para mostrar" var="var" value="#{instrumentoManagedBean.instrumentos}" selection="#{instrumentoManagedBean.selectedInstrumento}" paginator="true" rows="10" rowKey="#{var.id}" selectionMode="single">
							<p:ajax event="rowSelect" listener="#{instrumentoManagedBean.onRowSelect}" update=":guias:display"/>  
							<p:ajax event="rowUnselect" listener="#{instrumentoManagedBean.onRowUnselect}" update=":guias:display"/>    
							<f:facet name="header">
								Instrumentos existentes
							</f:facet>
							<p:column headerText="Instrumento"><h:outputText value="#{var.tipo.valor}" /></p:column>
							<p:column headerText="Unidad de Competencia"><h:outputText value="#{var.unidad.competenciaDescripcion}" /></p:column>
							<p:column headerText="Codigo"><h:outputText value="#{var.codigo}" /></p:column>  
							<p:column headerText="Nombre"><h:outputText value="#{var.nombre}" /></p:column>  
							<p:column headerText="Puntaje Minimo"><h:outputText value="#{var.puntajeMinimo}" /></p:column>  
							<p:column headerText="Estado"><h:outputText value="#{var.estatusLabel}" /></p:column>
							<p:column headerText="Editar" style="width:4%">
								<p:commandButton id="selectButton" action="#{instrumentoManagedBean.editarInstrumento(instrumentoManagedBean.selectedInstrumento)}" update=":instrumentoDialogo" icon="ui-icon-pencil" title="Editar" onclick="PF('dlg2').show();"/>  
							</p:column>
						</p:dataTable>
						</h:form>
		          </div>
		</div>
	</div>

	<p:dialog id="modalDialog1" styleClass="estilo_dialogoactividades" header="Edicion de Guia:" widgetVar="dlg1" modal="true" resizable="false" width="350" height="300">
		<div id="contenedor_dialogoactividades">
		<h:panelGrid id="modal1" columns="2" cellpadding="4">
		<h:form id="guiaDialogo">
		  	<h:outputLabel styleClass="estilo_label" value="Pregunta:" />  
            <p:inputText id="codigo1" value="#{instrumentoManagedBean.guia.pregunta}" />
            <br/>	
            <h:outputLabel styleClass="estilo_label" value="Respuesta:" />
            <p:inputText id="codigo2" value="#{instrumentoManagedBean.guia.respuesta}" />
            <br/>	
            <h:outputLabel styleClass="estilo_label" value="Puntaje:" />
            <p:inputText id="codigo3" value="#{instrumentoManagedBean.guia.puntaje}" />
            <br/>
            <h:outputLabel styleClass="estilo_label" value="Activo:" />
			<p:selectBooleanCheckbox value="#{instrumentoManagedBean.guia.estatus}" />
			<br/>	
			<div class="contenedor_botones" style="margin-top:32px;">			
	            <h:commandButton value="Cancelar" onclick="PF('dlg1').hide();"/> 
				<h:commandButton value="Aceptar" update=":guias:display" action="#{instrumentoManagedBean.guardarGuia(instrumentoManagedBean.guia)}" onclick="PF('dlg1').hide();"/>
			</div>
		</h:form>
		</h:panelGrid>
		</div>
	</p:dialog>	
	
	<p:dialog id="modalDialog2" styleClass="estilo_dialogoactividades" header="Edicion de Instrumento:" widgetVar="dlg2" modal="true" resizable="false" width="350" height="350">
		<div id="contenedor_dialogoactividades">
		<h:panelGrid id="modal2" columns="2" cellpadding="5">
		<h:form id="instrumentoDialogo">
		  	<h:outputLabel styleClass="estilo_label" value="Instrumento:" />
			<p:selectOneMenu id="selector_estatus1" styleClass="selector_status_estilo" value="#{instrumentoManagedBean.selectedTipoInstrumento}" >  
				<f:selectItem itemLabel="Seleccione..." itemValue="" />
				<f:selectItems value="#{instrumentoManagedBean.catalogoTiposInstrumento}" var="tipo" itemLabel="#{tipo.valor}" itemValue="#{tipo.id}" />
			</p:selectOneMenu>
            <br/>	
            <h:outputLabel styleClass="estilo_label" value="Unidad:" />
			<p:selectOneMenu id="selector_estatus2" styleClass="selector_status_estilo" value="#{instrumentoManagedBean.selectedUnidad}" >  
				<f:selectItem itemLabel="Seleccione..." itemValue="" />
				<f:selectItems value="#{instrumentoManagedBean.catalogoUnidades}" var="unidad" itemLabel="#{unidad.competenciaDescripcion}" itemValue="#{unidad.id}" />
			</p:selectOneMenu>
            <br/> 
            <h:outputLabel styleClass="estilo_label" value="Codigo:" />
            <p:inputText id="codigo4" value="#{instrumentoManagedBean.instrumento.codigo}" />
            <br/>
            <h:outputLabel styleClass="estilo_label" value="Nombre:" />
			<p:inputText id="codigo5" value="#{instrumentoManagedBean.instrumento.nombre}" />
			<br/>
            <h:outputLabel styleClass="estilo_label" value="Puntaje Minimo:" />
			<p:inputText id="codigo6" value="#{instrumentoManagedBean.instrumento.puntajeMinimo}" />
			<br/>
            <h:outputLabel styleClass="estilo_label" value="Activo:" />
			<p:selectBooleanCheckbox value="#{instrumentoManagedBean.instrumento.estatus}" />
			<br/>
			<div class="contenedor_botones" style="margin-top:32px;">		
	            <h:commandButton value="Cancelar" onclick="PF('dlg2').hide();"/> 
				<h:commandButton value="Aceptar" update=":instrumentos:instrumentosDataTable" action="#{instrumentoManagedBean.guardarInstrumento(instrumentoManagedBean.instrumento)}" onclick="PF('dlg2').hide();"/>
			</div>
		</h:form>
		</h:panelGrid>
		</div>
	</p:dialog>
</h:body>
</html>